{% extends 'base.html' %}

{% block title %}Gi·ªè h√†ng{% endblock %}

{% block content %}
<h2 style="margin-bottom: 1.5rem;">üõí Gi·ªè h√†ng c·ªßa b·∫°n</h2>

{% if cart_items %}
<div class="card">
    <table>
        <thead>
            <tr>
                <th>S√°ch</th>
                <th>Gi√°</th>
                <th>S·ªë l∆∞·ª£ng</th>
                <th>T·ªïng</th>
                <th>H√†nh ƒë·ªông</th>
            </tr>
        </thead>
        <tbody>
            {% for item in cart_items %}
            <tr>
                <td>
                    <strong>{{ item.book.title }}</strong><br>
                    <small style="color: #7f8c8d;">{{ item.book.author }}</small>
                </td>
                <td>${{ item.book.price }}</td>
                <td>
                    <form method="POST" action="{% url 'web_update_cart_item' item.id %}" style="display: inline;">
                        {% csrf_token %}
                        <input type="number" name="quantity" value="{{ item.quantity }}" min="1" 
                               max="{{ item.book.stock_quantity }}" 
                               style="width: 60px; padding: 0.3rem; border: 1px solid #ddd; border-radius: 4px;"
                               onchange="this.form.submit()">
                    </form>
                </td>
                <td><strong>${{ item.book.price|floatformat:2 }}</strong></td>
                <td>
                    <form method="POST" action="{% url 'web_remove_from_cart' item.id %}" style="display: inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger" style="padding: 0.3rem 1rem;">X√≥a</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <td colspan="3" style="text-align: right;"><strong>T·ªïng c·ªông:</strong></td>
                <td><strong style="color: #27ae60; font-size: 1.2rem;">${{ total }}</strong></td>
                <td></td>
            </tr>
        </tfoot>
    </table>
    
    <div style="margin-top: 2rem; display: flex; justify-content: space-between;">
        <a href="{% url 'web_home' %}" class="btn btn-secondary">‚Üê Ti·∫øp t·ª•c mua s·∫Øm</a>
        <a href="{% url 'web_checkout' %}" class="btn btn-success">Thanh to√°n ‚Üí</a>
    </div>
</div>
{% else %}
<div class="alert alert-danger">
    Gi·ªè h√†ng tr·ªëng. <a href="{% url 'web_home' %}">Mua s·∫Øm ngay!</a>
</div>
{% endif %}
{% endblock %}
