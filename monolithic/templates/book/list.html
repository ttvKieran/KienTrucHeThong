{% extends 'base.html' %}

{% block title %}Danh s√°ch s√°ch{% endblock %}

{% block content %}
<h2 style="margin-bottom: 1.5rem;">Danh s√°ch s√°ch</h2>

<div style="display: flex; gap: 1rem; margin-bottom: 2rem;">
    <form method="GET" style="display: flex; gap: 1rem; flex: 1;">
        <input type="text" name="q" placeholder="T√¨m ki·∫øm s√°ch, t√°c gi·∫£..." value="{{ search_query|default:'' }}"
               style="flex: 1; padding: 0.7rem; border: 1px solid #ddd; border-radius: 4px; font-size: 1rem;">
        
        <select name="category" style="padding: 0.7rem; border: 1px solid #ddd; border-radius: 4px; font-size: 1rem;">
            <option value="">T·∫•t c·∫£ danh m·ª•c</option>
            {% for category in categories %}
            <option value="{{ category.id }}" {% if selected_category == category.id|stringformat:"s" %}selected{% endif %}>
                {{ category.name }}
            </option>
            {% endfor %}
        </select>
        
        <button type="submit" class="btn">üîç T√¨m ki·∫øm</button>
    </form>
</div>

{% if books %}
<div class="grid">
    {% for book in books %}
    <div class="card">
        <h3 style="margin-bottom: 0.5rem; color: #2c3e50;">{{ book.title }}</h3>
        <p style="color: #7f8c8d; margin-bottom: 0.5rem;">{{ book.author }}</p>
        <p style="color: #3498db; margin-bottom: 0.5rem;"><strong>{{ book.category.name }}</strong></p>
        <p style="font-size: 1.2rem; color: #27ae60; margin-bottom: 0.5rem;"><strong>${{ book.price }}</strong></p>
        <p style="color: {% if book.stock_quantity > 10 %}#27ae60{% elif book.stock_quantity > 0 %}#e67e22{% else %}#e74c3c{% endif %}; margin-bottom: 1rem;">
            Kho: {{ book.stock_quantity }} cu·ªën
        </p>
        
        <div style="display: flex; gap: 0.5rem;">
            <a href="{% url 'web_book_detail' book.id %}" class="btn btn-secondary" style="flex: 1; text-align: center;">
                Chi ti·∫øt
            </a>
            {% if book.stock_quantity > 0 %}
            <form method="POST" action="{% url 'web_add_to_cart' book.id %}" style="flex: 1;">
                {% csrf_token %}
                <input type="hidden" name="quantity" value="1">
                <button type="submit" class="btn btn-success" style="width: 100%;">+ Gi·ªè</button>
            </form>
            {% else %}
            <button class="btn btn-danger" style="flex: 1;" disabled>H·∫øt h√†ng</button>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="alert alert-danger">Kh√¥ng t√¨m th·∫•y s√°ch n√†o.</div>
{% endif %}
{% endblock %}
