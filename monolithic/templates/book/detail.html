{% extends 'base.html' %}

{% block title %}{{ book.title }}{% endblock %}

{% block content %}
<a href="{% url 'web_home' %}" class="btn btn-secondary" style="margin-bottom: 1rem;">‚Üê Quay l·∫°i</a>

<div class="card">
    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 2rem;">
        <div style="background: #ecf0f1; height: 300px; display: flex; align-items: center; justify-content: center; border-radius: 8px;">
            <span style="font-size: 4rem;">üìñ</span>
        </div>
        
        <div>
            <h2 style="margin-bottom: 1rem; color: #2c3e50;">{{ book.title }}</h2>
            <p style="font-size: 1.1rem; color: #7f8c8d; margin-bottom: 1rem;">
                <strong>T√°c gi·∫£:</strong> {{ book.author }}
            </p>
            <p style="margin-bottom: 1rem;">
                <strong>Danh m·ª•c:</strong> 
                <span style="background: #3498db; color: white; padding: 0.3rem 0.8rem; border-radius: 4px;">
                    {{ book.category.name }}
                </span>
            </p>
            <p style="font-size: 1.5rem; color: #27ae60; margin-bottom: 1rem;">
                <strong>Gi√°: ${{ book.price }}</strong>
            </p>
            <p style="margin-bottom: 1rem; color: {% if book.stock_quantity > 10 %}#27ae60{% elif book.stock_quantity > 0 %}#e67e22{% else %}#e74c3c{% endif %};">
                <strong>T·ªìn kho:</strong> {{ book.stock_quantity }} cu·ªën
            </p>
            
            {% if avg_rating %}
            <p style="margin-bottom: 1rem; color: #f39c12;">
                <strong>‚≠ê ƒê√°nh gi√°:</strong> {{ avg_rating|floatformat:1 }}/5.0 ({{ ratings|length }} ƒë√°nh gi√°)
            </p>
            {% endif %}
            
            <div style="margin-top: 2rem;">
                {% if book.stock_quantity > 0 %}
                <form method="POST" action="{% url 'web_add_to_cart' book.id %}">
                    {% csrf_token %}
                    <div style="display: flex; gap: 1rem; align-items: center;">
                        <label>S·ªë l∆∞·ª£ng:</label>
                        <input type="number" name="quantity" value="1" min="1" max="{{ book.stock_quantity }}" 
                               style="width: 80px; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
                        <button type="submit" class="btn btn-success">üõí Th√™m v√†o gi·ªè</button>
                    </div>
                </form>
                {% else %}
                <button class="btn btn-danger" disabled>H·∫øt h√†ng</button>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="card" style="margin-top: 2rem;">
    <h3 style="margin-bottom: 1rem;">ƒê√°nh gi√° t·ª´ kh√°ch h√†ng</h3>
    {% if ratings %}
    {% for rating in ratings %}
    <div style="padding: 1rem; background: #f8f9fa; border-radius: 4px; margin-bottom: 0.5rem;">
        <strong>{{ rating.customer.name }}</strong> - <span style="color: #f39c12;">‚≠ê {{ rating.score }}/5.0</span>
    </div>
    {% endfor %}
    {% else %}
    <p style="color: #7f8c8d;">Ch∆∞a c√≥ ƒë√°nh gi√°.</p>
    {% endif %}
</div>

{% if similar_books %}
<div class="card" style="margin-top: 2rem;">
    <h3 style="margin-bottom: 1rem;">S√°ch t∆∞∆°ng t·ª±</h3>
    <div class="grid">
        {% for similar in similar_books %}
        <div style="padding: 1rem; background: #f8f9fa; border-radius: 4px;">
            <h4 style="margin-bottom: 0.5rem;">{{ similar.title }}</h4>
            <p style="color: #7f8c8d;">{{ similar.author }}</p>
            <p style="color: #27ae60;"><strong>${{ similar.price }}</strong></p>
            <a href="{% url 'web_book_detail' similar.id %}" class="btn btn-secondary" style="margin-top: 0.5rem; width: 100%; text-align: center;">
                Xem
            </a>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}
{% endblock %}
